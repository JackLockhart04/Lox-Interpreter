// test_big.txt - broad interpreter integration test

// Arithmetic and grouping
print 1 + 2 * 3;           // 1 + (2*3) = 7
print (1 + 2) * 3;         // (1+2)*3 = 9
print 3.0;                 // prints 3 (no trailing .0)

// Strings and concatenation
print "hello";
print "one " + "two";
print "one " + 1;        // string + number -> string concatenation
print 1 + "two";         // number + string -> string concatenation

// Variables and assignment-as-expression
var beverage = "espresso";
print beverage;
var x = 10;
print x;
var r = (x = 42);
print r;                   // should print 42
print x;                   // x updated to 42

// Functions, calls and return
fun add(a, b) {
  return a + b;
}
print add(2, 3);

// Closures: factory that returns a counter function
fun makeCounter() {
  var i = 0;
  fun count() {
    i = i + 1;
    return i;
  }
  return count;
}
var c = makeCounter();
print c();
print c();

// Recursion (factorial)
fun fact(n) {
  if (n <= 1) return 1;
  return n * fact(n - 1);
}
print fact(6); // 720

// Logical ops + short-circuiting side effects
var sc = false;
true or (sc = true);
print sc; // false
false or (sc = true);
print sc; // true

// Scoping and shadowing
var vol = 11;
{
  var vol = 3 * 4 * 5;
  print vol; // inner
}
print vol; // outer

// While and for loops
var i = 0;
while (i < 2) {
  print i;
  i = i + 1;
}

for (var j = 0; j < 3; j = j + 1) print j;

// Native function usage
var t = clock();
print t;

// Intentional runtime errors (should be reported but not crash)
print before_decl;
"not a function"();
clock(1); // wrong arity for native clock

// Block comment / nested comment test
/* outer /* nested */ still outer */
print "block comments ok";

// End
